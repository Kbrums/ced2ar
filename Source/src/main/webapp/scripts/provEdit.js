function preSelectObj(e){e+="#",$("#provObjExisting option[value^='"+e+"']").prop("selected",!0),$("#provObjExisting").removeClass("hidden"),$("input[name='objSelect'][value='existingNode']").prop("checked","checked"),$("#psObject").val("")}function preSelectSub(e){e+="#",$("#provSubExisting option[value^='"+e+"']").prop("selected",!0),$("#provSubExisting").removeClass("hidden"),$("input[name='subSelect'][value='existingNode']").prop("checked","checked"),$("#psSubject").val("")}function enableObjSelect(){$("input[name='objSelect']").unbind(),$("input[name='objSelect']").change(function(){console.log("val "+$(this).val()),"existingNode"==$(this).val()?($("#provObjExisting").removeClass("hidden"),$("#provObjNew").addClass("hidden")):($("#provObjNew").removeClass("hidden"),$("#provObjExisting").addClass("hidden")),enableObjSelect()})}function enableSubSelect(){$("input[name='subSelect']").unbind(),$("input[name='subSelect']").change(function(){"existingNode"==$(this).val()?($("#provSubExisting").removeClass("hidden"),$("#provSubNew").addClass("hidden")):($("#provSubNew").removeClass("hidden"),$("#provSubExisting").addClass("hidden")),enableSubSelect()})}function listenPred(){$("#provForm").change(function(){selectPred()})}function selectPred(){if(objType=-1,subType=-1,objLabel="",subLabel="","existingNode"==$("input:checked[name='objSelect']").val()){var e=$("#provObjExisting select").val();null!==e&&(objType=e.split("#")[1],objLabel=$("#provObjExisting :selected").text())}else"newNode"==$("input:checked[name='objSelect']").val()&&(objType=$("#provObjNew select").val(),objLabel=$("#objLabel").val());if("existingNode"==$("input:checked[name='subSelect']").val()){var t=$("#provSubExisting select").val();null!==t&&(subType=t.split("#")[1],subLabel=$("#provSubExisting :selected").text())}else"newNode"==$("input:checked[name='subSelect']").val()&&(subType=$("#provSubNew select[name='provSubClass']").val(),subLabel=$("#subLabel").val());if(objType>=0&&subType>=0)switch($("#provPreviewObj").html(objLabel),$("#provPreviewSub").html(subLabel),$("#provAddButton").removeClass("disabled"),$("#provAddButton").removeAttr("disabled"),objType){case"0":loadPred(subType);break;case"1":switch(subType){case"0":loadPred(4);break;case"1":loadPred(3);break;case"2":loadPred(5)}break;case"2":switch(subType){case"0":loadPred(6);break;case"1":loadPred(7);break;case"2":loadPred(8)}}else $("#provAddButton").addClass("disabled"),$("#provAddButton").attr("disabled",!0),$("#provPreviewObj").empty(),$("#provPreviewSub").empty(),$("#provPreviewPred").empty()}function loadPred(e){console.log("Loading predicates for condition "+e);var t=JSON.parse($("#provEditPred input[type='hidden']").val())[e];$("#provEditPred select").empty(),$("#provEditPred select").removeAttr("disabled"),$("#provEditPred select").removeClass("disabled"),t.forEach(function(e){$("#provEditPred select").append("<option value='"+e.id+"'>"+e.label+"</option>")}),$("#provPreviewPred").html($("#provEditPred :selected").text())}function changePred(){$("#provEditPred select").change(function(){$("#provPreviewPred").html($("#provEditPred :selected").text())})}function listenSubmit(){$("#provForm").submit(function(){$("#provErrors").empty();var e="";if(-1===objType&&(e+="Object type is required <br /> "),-1===subType&&(e+="Subject type is required <br />"),"newNode"==$("input:checked[name='objSelect']").val()){var t=$("#objID").val();""===t&&(e+="Object ID is required <br />"),""===objLabel&&(e+="Object label is required <br />"),""===$("#objURI").val()&&(e+="Object URI is required <br />")}if("newNode"==$("input:checked[name='subSelect']").val()){var r=$("#subID").val();""===r&&(e+="Subject ID is required <br />"),""===subLabel&&(e+="Subject label is required <br />"),""===$("#subURI").val()&&(e+="Subject URI is required <br />")}return""!==e?$("#provErrors").html(e):($("#provErrors").empty(),$("#provStatus").empty(),$.ajax({cache:!1,type:"POST",data:$("#provForm").serialize(),url:baseURI+"/edit/prov",success:function(e){if(200===e.status){var t=e.responseText;t+="<br /><a href='"+baseURI+"/prov2'>View on graph</a>",$("#provStatus").html(t)}},error:function(e){if(200===e.status){var t=e.responseText;t+="<br /><a href='"+baseURI+"/prov2'>View on graph</a>",$("#provStatus").html(t)}else $("#provErrors").html(e.responseText)}})),!1})}$(document).ready(function(){objType=-1,subType=-1,objLabel="",subLabel="",baseURI=$("#meta_uri").html(),enableObjSelect(),enableSubSelect(),listenPred(),changePred(),listenSubmit(),$("input[name='objSelect']").prop("checked",!1),$("input[name='subSelect']").prop("checked",!1);var e=$("#psObject").val();""!==e&&preSelectObj(e);var t=$("#psSubject").val();""!==t&&preSelectSub(t)});